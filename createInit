#!/bin/sh

# Copyright (C) 2012 Jonathan Vasquez
#
# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.

# Description
# ------------
# This will be the entry point of the application.
# It will display a menu, and depending on the options chosen,
# It will ask for necessary information.
# Once the information is gathered, it will pass that info to
# the appropriate hook in which the initramfs will be created.

# Source functions
. resources/variables.sh
. resources/functions_generic.sh

#######################################################################
# The main entry point starts here
#######################################################################
clear

message_header

display_menu

get_arch

chk_mod_dir

clean

message_start

crt_dir_struct

chk_bin && cp_bin

chk_mod && cp_mod

# If it's a ZFS initrd, compress the copied modules and generate modules.dep
if [ ${INIT_TYPE} = "ZFS" ]; then
	gz_mods && gen_depm 
fi

cp_deps

crt_sym

conf_init

crt_initrd

clean_all
