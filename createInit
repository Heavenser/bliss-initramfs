#!/bin/sh

# Copyright (C) 2012 Jonathan Vasquez
#
# This source code is released under the MIT license which can be found
# in the LICENSE file.

# Description
# ------------
# This will be the entry point of the application.
# It will display a menu, and depending on the options chosen,
# It will ask for necessary information.
# Once the information is gathered, it will pass that info to
# the appropriate hook in which the initramfs will be created.

# Source functions
. resources/variables.sh
. resources/functions_generic.sh

#######################################################################
# The main entry point starts here
#######################################################################
clear

message_header

display_menu

get_arch

chk_mod_dir

clean

message_start

crt_dir_struct

chk_bins && cp_bins

chk_mods && cp_mods

# If it's a ZFS initrd, compress the copied modules and generate modules.dep
if [ ${INIT_TYPE} = "ZFS" ]; then
	gz_mods && gen_depm 
fi

cp_deps

crt_sym

conf_init

crt_initrd

clean_all
